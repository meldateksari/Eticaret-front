<div class="relative flex size-full min-h-screen flex-col bg-[#fcf8f8] group/design-root overflow-x-hidden" style='font-family: "Plus Jakarta Sans", "Noto Sans", sans-serif;'>
  <div class="layout-container flex h-full grow flex-col">
    <div class="px-40 flex flex-1 justify-center py-5 gap-10">

      <!-- âœ… SOL TARAF: Sidebar -->
      <div class="layout-content-container flex flex-col w-80">
        <div class="flex h-full min-h-[700px] flex-col justify-between bg-[#fcf8f8] p-4">
          <app-profile-sidebar></app-profile-sidebar>
        </div>
      </div>
<div class="layout-content-container flex flex-col max-w-[960px] flex-1">

  <!-- Title -->
  <div class="flex flex-wrap justify-between gap-3 p-4">
    <p class="text-[#1b0e0f] text-[32px] font-bold">My Addresses</p>
  </div>

  <h3 class="text-[#1b0e0f] text-lg font-bold px-4 pb-2 pt-4">Saved Addresses</h3>

  <!-- Address Cards -->
  <div class="space-y-4 px-4">
    <div
      *ngFor="let address of addresses"
      class="w-full flex items-start justify-between gap-4 bg-[#fcf8f8] px-6 py-4 rounded-md shadow-sm"
    >
      <div class="flex items-start gap-4">
        <!-- Icon -->
        <div class="flex items-center justify-center rounded-lg bg-[#f3e7e8] shrink-0 size-12">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 256 256">
            <path d="M218.83,103.77l-80-75.48a16,16,0,0,0-21.66,0l-80,75.48A16,16,0,0,0,32,115.55V208a16,16,0,0,0,16,16H96a16,16,0,0,0,16-16V160h32v48a16,16,0,0,0,16,16h48a16,16,0,0,0,16-16V115.55A16,16,0,0,0,218.83,103.77ZM208,208H160V160a16,16,0,0,0-16-16H112a16,16,0,0,0-16,16v48H48V115.55L128,40l80,75.55Z"/>
          </svg>
        </div>

        <!-- Address Details -->
        <div class="flex flex-col">
          <p class="text-[#1b0e0f] text-base font-medium">
            {{ address.isDefault ? 'Default Address' : 'Address' }}
          </p>
          <p class="text-[#974e52] text-sm">{{ address.addressLine1 }}</p>
          <p *ngIf="address.addressLine2" class="text-[#974e52] text-sm">{{ address.addressLine2 }}</p>
          <p class="text-[#974e52] text-sm">{{ address.city }}, {{ address.state }} {{ address.zipCode }}</p>
          <p class="text-[#974e52] text-sm">{{ address.country }}</p>
        </div>
      </div>

      <!-- Edit Icon -->
      <div class="shrink-0 flex items-start">
        <div
          class="text-[#1b0e0f] flex size-7 items-center justify-center cursor-pointer"
          (click)="openEditModal(address)"
        >
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 256 256">
            <path d="M227.31,73.37l-44.69-44.69a16,16,0,0,0-22.63,0L36.69,152A16,16,0,0,0,32,163.31V208a16,16,0,0,0,16,16H92.69a16,16,0,0,0,11.32-4.69L227.31,96a16,16,0,0,0,0-22.63ZM92.69,208H48V163.31L136,75.31,180.69,120Zm99.31-99.32L147.31,64l24-24L216,84.69Z"/>
          </svg>
        </div>
      </div>
    </div>
  </div>

  <div class="flex justify-start px-4 py-6">
    <button
      (click)="toggleAddModal()"
      class="rounded-full h-10 px-5 bg-[#f3e7e8] text-[#1b0e0f] font-bold hover:bg-[#e9d5d6] transition"
    >
      Add New Address
    </button>
  </div>

  <!-- Add Address Modal -->
  <!-- Add Address Modal -->
  <div
    *ngIf="showAddModal"
    class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50"
  >
    <div class="bg-white p-6 rounded-lg shadow-lg w-full max-w-md relative">
      <!-- Kapatma Butonu -->
      <button
        (click)="toggleAddModal()"
        class="absolute top-2 right-2 text-gray-600 hover:text-black text-xl"
      >
        &times;
      </button>

      <h2 class="text-lg font-semibold mb-4">Add New Address</h2>

      <form (ngSubmit)="addNewAddress()" #addressForm="ngForm">
        <input
          type="text"
          name="addressLine1"
          [(ngModel)]="newAddress.addressLine1"
          placeholder="Address Line 1"
          required
          class="border p-2 mb-2 w-full"
        />

        <input
          type="text"
          name="addressLine2"
          [(ngModel)]="newAddress.addressLine2"
          placeholder="Address Line 2"
          class="border p-2 mb-2 w-full"
        />

        <!-- Country Dropdown -->
        <select
          name="country"
          [(ngModel)]="newAddress.country"
          (change)="onCountrySelected()"
          required
          class="border p-2 mb-2 w-full"
        >
          <option value="" disabled selected>Select a country</option>
          <option *ngFor="let country of countries" [value]="country.name">
            {{ country.name }}
          </option>
        </select>

        <!-- City Dropdown -->
        <select
          name="city"
          [(ngModel)]="newAddress.city"
          required
          class="border p-2 mb-2 w-full"
          [disabled]="!newAddress.country || isLoadingCities"
        >
          <option value="" disabled selected>
            {{ isLoadingCities ? 'Loading cities...' :
            !newAddress.country ? 'First select a country' : 'Select a city' }}
          </option>
          <option *ngFor="let city of cities" [value]="city">
            {{ city }}
          </option>
        </select>
        <!-- Loading indicator (isteÄŸe baÄŸlÄ±) -->
        <div *ngIf="isLoadingCities" class="text-sm text-gray-500 mb-2">
          ğŸ”„ Loading cities...
        </div>

        <input
          type="text"
          name="state"
          [(ngModel)]="newAddress.state"
          placeholder="State"
          required
          class="border p-2 mb-2 w-full"
        />

        <input
          type="text"
          name="zipCode"
          [(ngModel)]="newAddress.zipCode"
          placeholder="Zip Code"
          required
          class="border p-2 mb-2 w-full"
        />

        <label class="flex items-center space-x-2 mb-4">
          <input
            type="checkbox"
            name="isDefault"
            [(ngModel)]="newAddress.isDefault"
            class="h-4 w-4"
          />
          <span>Use as default address</span>
        </label>

        <button
          type="submit"
          class="rounded-full h-10 px-5 bg-[#cbe3c1] text-black font-bold hover:bg-[#b2d7a3] transition w-full"
        >
          Save Address
        </button>
      </form>
    </div>
  </div>




  <!-- Edit Modal -->
  <div *ngIf="editingAddress" class="fixed inset-0 z-50 bg-black bg-opacity-40 flex items-center justify-center">
    <div class="bg-white p-6 rounded-lg w-[400px] shadow-lg">
      <h2 class="text-xl font-semibold mb-4">Edit Address</h2>

      <form (ngSubmit)="submitEditForm()" #editForm="ngForm">
        <input class="w-full mb-2 p-2 border" [(ngModel)]="editingAddress.addressLine1" name="line1" placeholder="Address Line 1" required />
        <input class="w-full mb-2 p-2 border" [(ngModel)]="editingAddress.addressLine2" name="line2" placeholder="Address Line 2" />
        <input class="w-full mb-2 p-2 border" [(ngModel)]="editingAddress.city" name="city" placeholder="City" required />
        <input class="w-full mb-2 p-2 border" [(ngModel)]="editingAddress.state" name="state" placeholder="State" required />
        <input class="w-full mb-2 p-2 border" [(ngModel)]="editingAddress.zipCode" name="zip" placeholder="Zip Code" required />
        <input class="w-full mb-2 p-2 border" [(ngModel)]="editingAddress.country" name="country" placeholder="Country" required />

        <label class="flex items-center mb-4">
          <input type="checkbox" [(ngModel)]="editingAddress.isDefault" name="isDefault" class="mr-2" />
          Default Address
        </label>

        <div class="flex justify-end gap-2">
          <button type="button" (click)="closeModal()" class="px-4 py-2 bg-gray-200 rounded">Cancel</button>
          <button type="submit" [disabled]="editForm.invalid" class="px-4 py-2 bg-blue-600 text-white rounded">Save</button>
        </div>
      </form>
    </div>
  </div>
</div>
    </div>
  </div>
</div>
