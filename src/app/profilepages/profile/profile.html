<html>
<head>
  <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin="" />
  <link
    rel="stylesheet"
    as="style"
    onload="this.rel='stylesheet'"
    href="https://fonts.googleapis.com/css2?display=swap&amp;family=Noto+Sans%3Awght%40400%3B500%3B700%3B900&amp;family=Plus+Jakarta+Sans%3Awght%40400%3B500%3B700%3B800"
  />

  <link rel="icon" type="image/x-icon" href="data:image/x-icon;base64," />

  <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
</head>
<body>
<div class="relative flex size-full min-h-screen flex-col bg-[#fbf9f9] group/design-root overflow-x-hidden" style='font-family: "Plus Jakarta Sans", "Noto Sans", sans-serif;'>
  <div class="layout-container flex h-full grow flex-col">
    <div class="gap-1 px-6 flex flex-1 justify-center py-5">
      <div class="layout-content-container flex flex-col w-80">
        <div class="flex h-full min-h-[700px] flex-col justify-between bg-[#fbf9f9] p-4">
          <div class="flex flex-col gap-4">
            <app-profile-sidebar></app-profile-sidebar>
          </div>
        </div>
      </div>
      <!-- Main content -->
      <div class="layout-content-container flex flex-col max-w-[960px] flex-1">
        <div class="flex flex-wrap justify-between gap-3 p-4">
          <p class="text-[#191011] tracking-light text-[32px] font-bold leading-tight min-w-72">
            Profile | My Account
          </p>
        </div>

        <!-- Account Details -->
        <h3 class="text-[#191011] text-lg font-bold leading-tight tracking-[-0.015em] px-4 pb-2 pt-4">
          Account Details
        </h3>

        <form [formGroup]="profileFormValue" (ngSubmit)="updateAccount()" *ngIf="profileFormValue">
          <!-- First Name -->
          <div class="flex max-w-[480px] flex-wrap items-end gap-4 px-4 py-3">
            <label class="flex flex-col min-w-40 flex-1">
              <p class="pb-2 text-[#191011] text-base font-medium">Name</p>
              <input
                formControlName="firstName"
                class="form-input w-full rounded-xl border border-[#e3d4d5] bg-[#fbf9f9] h-14 p-[15px] text-base text-[#191011] placeholder:text-[#8b5b5d] focus:border-[#e3d4d5] focus:outline-0"
                placeholder="Enter your first name (optional)"
              />
              <div
                *ngIf="profileFormValue.get('firstName')?.invalid && profileFormValue.get('firstName')?.touched"
                class="text-red-500 text-sm mt-1"
              >
                <span *ngIf="profileFormValue.get('firstName')?.errors?.['minlength']">
                  Name must be at least 2 characters
                </span>
              </div>
            </label>
          </div>

          <!-- Last Name -->
          <div class="flex max-w-[480px] flex-wrap items-end gap-4 px-4 py-3">
            <label class="flex flex-col min-w-40 flex-1">
              <p class="pb-2 text-[#191011] text-base font-medium">Surname</p>
              <input
                formControlName="lastName"
                class="form-input w-full rounded-xl border border-[#e3d4d5] bg-[#fbf9f9] h-14 p-[15px] text-base text-[#191011] placeholder:text-[#8b5b5d] focus:border-[#e3d4d5] focus:outline-0"
                placeholder="Enter your last name (optional)"
              />
              <div
                *ngIf="profileFormValue.get('lastName')?.invalid && profileFormValue.get('lastName')?.touched"
                class="text-red-500 text-sm mt-1"
              >
                <span *ngIf="profileFormValue.get('lastName')?.errors?.['minlength']">
                  Surname must be at least 2 characters
                </span>
              </div>
            </label>
          </div>

          <!-- Email -->
          <div class="flex max-w-[480px] flex-wrap items-end gap-4 px-4 py-3">
            <label class="flex flex-col min-w-40 flex-1">
              <p class="pb-2 text-[#191011] text-base font-medium">Email</p>
              <input
                formControlName="email"
                type="email"
                class="form-input w-full rounded-xl border border-[#e3d4d5] bg-[#fbf9f9] h-14 p-[15px] text-base text-[#191011] placeholder:text-[#8b5b5d] focus:border-[#e3d4d5] focus:outline-0"
                placeholder="Enter your email (optional)"
              />
              <div
                *ngIf="profileFormValue.get('email')?.invalid && profileFormValue.get('email')?.touched"
                class="text-red-500 text-sm mt-1"
              >
                <span *ngIf="profileFormValue.get('email')?.errors?.['email']">Please enter a valid email</span>
              </div>
            </label>
          </div>

          <!-- Profile Photo Upload -->
          <div class="flex max-w-[480px] flex-col gap-4 px-4 py-3">
            <p class="text-[#191011] text-base font-medium">Profile Photo</p>

            <!-- Image Preview -->
            <div *ngIf="imageUrl" class="mb-3">
<!--              <img [src]="imageUrl" alt="Profile Image" class="w-32 h-32 rounded-full object-cover border" />-->
              <img src="data:image/jpeg;base64,{{(userO | async)?.image}}" alt="Profile Image">

            </div>

            <!-- PrimeNG File Upload -->
            <p-fileUpload
              name="file"
              customUpload="true"
              accept="image/*"
              chooseLabel="Select Image"
              (uploadHandler)="uploadProfileImage($event)"
              auto
              [showUploadButton]="false"
              [showCancelButton]="false"
            ></p-fileUpload>
          </div>


          <!-- Phone Number -->
          <div class="flex max-w-[480px] flex-wrap items-end gap-4 px-4 py-3">
            <label class="flex flex-col min-w-40 flex-1">
              <p class="pb-2 text-[#191011] text-base font-medium">Phone Number</p>
              <input
                formControlName="phoneNumber"
                type="tel"
                class="form-input w-full rounded-xl border border-[#e3d4d5] bg-[#fbf9f9] h-14 p-[15px] text-base text-[#191011] placeholder:text-[#8b5b5d] focus:border-[#e3d4d5] focus:outline-0"
                placeholder="Enter your phone number (optional)"
              />
              <div
                *ngIf="profileFormValue.get('phoneNumber')?.invalid && profileFormValue.get('phoneNumber')?.touched"
                class="text-red-500 text-sm mt-1"
              >
                <span *ngIf="profileFormValue.get('phoneNumber')?.errors?.['pattern']">
                  Please enter a valid phone number (10-11 digits)
                </span>
              </div>
            </label>
          </div>

          <!-- Buttons -->
          <div class="flex px-4 py-3 gap-4 justify-start">
            <button
              type="submit"

              class="min-w-[120px] h-10 px-4 rounded-xl text-sm font-bold text-[#191011] bg-[#e8b4b7] hover:opacity-90 disabled:opacity-50 disabled:cursor-not-allowed"
            >
              Update Account
            </button>

            <button
              type="button"
              (click)="deleteAccount()"
              class="min-w-[120px] h-10 px-4 rounded-xl text-sm font-bold text-white bg-[#e53935] hover:bg-red-600"
            >
              Delete Account
            </button>
          </div>
        </form>

        <!-- Password Change -->
        <h3 class="text-[#191011] text-lg font-bold leading-tight tracking-[-0.015em] px-4 pb-2 pt-4">
          Password
        </h3>

        <form [formGroup]="passwordFormValue" (ngSubmit)="changePassword()" *ngIf="passwordFormValue">
          <!-- Current Password -->
          <div class="flex max-w-[480px] flex-wrap items-end gap-4 px-4 py-3">
            <label class="flex flex-col min-w-40 flex-1">
              <p class="pb-2 text-[#191011] text-base font-medium">Current Password</p>
              <input
                formControlName="currentPassword"
                type="password"
                placeholder="Enter current password"
                class="form-input w-full rounded-xl border border-[#e3d4d5] bg-[#fbf9f9] h-14 p-[15px] text-base text-[#191011] placeholder:text-[#8b5b5d] focus:border-[#e3d4d5] focus:outline-0"
              />
              <div
                *ngIf="passwordFormValue.get('currentPassword')?.invalid && passwordFormValue.get('currentPassword')?.touched"
                class="text-red-500 text-sm mt-1"
              >
                <span *ngIf="passwordFormValue.get('currentPassword')?.errors?.['required']">Current password is required</span>
              </div>
            </label>
          </div>

          <!-- New Password -->
          <div class="flex max-w-[480px] flex-wrap items-end gap-4 px-4 py-3">
            <label class="flex flex-col min-w-40 flex-1">
              <p class="pb-2 text-[#191011] text-base font-medium">New Password</p>
              <input
                formControlName="newPassword"
                type="password"
                placeholder="Enter new password"
                class="form-input w-full rounded-xl border border-[#e3d4d5] bg-[#fbf9f9] h-14 p-[15px] text-base text-[#191011] placeholder:text-[#8b5b5d] focus:border-[#e3d4d5] focus:outline-0"
              />
              <div
                *ngIf="passwordFormValue.get('newPassword')?.invalid && passwordFormValue.get('newPassword')?.touched"
                class="text-red-500 text-sm mt-1"
              >
                <span *ngIf="passwordFormValue.get('newPassword')?.errors?.['required']">New password is required</span>
                <span *ngIf="passwordFormValue.get('newPassword')?.errors?.['minlength']">Password must be at least 6 characters</span>
              </div>
            </label>
          </div>

          <!-- Confirm Password -->
          <div class="flex max-w-[480px] flex-wrap items-end gap-4 px-4 py-3">
            <label class="flex flex-col min-w-40 flex-1">
              <p class="pb-2 text-[#191011] text-base font-medium">Confirm New Password</p>
              <input
                formControlName="confirmPassword"
                type="password"
                placeholder="Confirm new password"
                class="form-input w-full rounded-xl border border-[#e3d4d5] bg-[#fbf9f9] h-14 p-[15px] text-base text-[#191011] placeholder:text-[#8b5b5d] focus:border-[#e3d4d5] focus:outline-0"
              />
              <div
                *ngIf="passwordFormValue.get('confirmPassword')?.invalid && passwordFormValue.get('confirmPassword')?.touched"
                class="text-red-500 text-sm mt-1"
              >
                <span *ngIf="passwordFormValue.get('confirmPassword')?.errors?.['required']">Please confirm your password</span>
              </div>
              <div
                *ngIf="passwordFormValue.hasError('mismatch') && passwordFormValue.get('confirmPassword')?.touched"
                class="text-red-500 text-sm mt-1"
              >
                <span>Passwords do not match</span>
              </div>
            </label>
          </div>

          <!-- Submit -->
          <div class="flex px-4 py-3 justify-start">
            <button
              type="submit"

              class="min-w-[120px] h-10 px-4 rounded-xl text-sm font-bold text-[#191011] bg-[#e8b4b7] hover:opacity-90 disabled:opacity-50 disabled:cursor-not-allowed"
            >
              Change Password
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>




</body>
</html>
